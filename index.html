<!DOCTYPE html>
<html>
    <head><ti
      <meta charset="UTF-8">
      <script type="text/javascript"  src="rapydscript.js"></script>
    </head>
    <body>
      <script>   var compiler = RapydScript.create_embedded_compiler();
        
///////////////////////////////////////////////////////////////////
eval(compiler.compile(`
def saveLib(name,content): #save content in the virtual filesystem
    path = '__stdlib__/' + name
    RapydScript.file_data[path] = content

def readLib(name): #retrieve and return content
    path = '__stdlib__/' + name
    return RapydScript.file_data[path]
    
def showLib(): 
    for filename in  dir(RapydScript.file_data)[-5:]:
      print(filename)             
`, options = { 'basedir':'__stdlib__','omit_baselib':true} )) ///////////////////////
/////////////////////////////////////////////////////////////////////////////////////

async function compileThis(name,content){ 
/////////////////////////////////////////
eval(compiler.compile(`
saveLib(name,content)
`,options = {'basedir':'__stdlib__', 'omit_baselib':true} ))
} 

async function pyInstall(fileName){
/////////////////////////////////////////
    const response = await fetch(fileName);
    const content = await response.text()
    console.log('pyInstalled ' + fileName ) //+ ':\n content:\n ' + content)
    await compileThis(fileName + 'j', content);

}

        
         Promise.all([   pyInstall('lyte.py'),
                         pyInstall('fetched.py'),
                         pyInstall('compiledThis.py'),
                         pyInstall('compiledThis2.py'),
                         pyInstall('compiledThis3.py'),
                    ]).then(doMain)
                
function doMain(){
//////////////////
eval(compiler.compile(` 
#this is where importing can happen
import lyte

import compiledThis
#import compiledThis2  #compiledThis2 is actually imported by compiledThis3.
import compiledThis3
import fetched

console.log(compiledThis.compiledContent) 
#console.log(compiledThis2.compiledContent) 
console.log(compiledThis3.compiledContent) 


`,options = {'basedir':'__stdlib__','omit_baselib':true} )) ////////////////////////
}
//doMain                            
                
    </script>
  </body>
</html>
